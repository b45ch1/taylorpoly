\RequirePackage{ifpdf}
\ifpdf
\documentclass[a4paper,12pt,twoside]{article}
\usepackage{microtype}
\else
\documentclass[a4paper,12pt,twoside,dvips]{article}
\fi

\usepackage[scale=0.85,includeheadfoot]{geometry}
\usepackage[medium]{titlesec}

\usepackage[utf8x]{inputenc}
\usepackage[english]{babel}

\usepackage[T1]{fontenc}

\usepackage{amsmath,amsfonts,amsthm, mathtools}
% \mathtoolsset{showonlyrefs,showmanualtags}
\mathtoolsset{showmanualtags}
\usepackage{subeqnarray}
\usepackage{latexsym}

\usepackage{mathptmx}
% \usepackage{dsfont}


\usepackage{parskip}
\usepackage{fancyhdr}
\pagestyle{fancy}
%\renewcommand{\headrulewidth}{0.4pt}


\usepackage{graphicx}
\usepackage{hyperref}

\usepackage{tikz}


\graphicspath{{pics/}}

%prevent that latex tries to fill the whole page evenly with text. This looks crap since there are often huge whitespaces between paragraphs
\raggedbottom

\input{commands}

\title{Numpy Enhancement Proposal}

\author{Sebastian~F. Walter\footnote{\texttt{sebastian.walter@gmail.com}}}



\begin{document}
\maketitle

\begin{abstract}
We propose to implement algorithms for truncated univariate Taylor polynomials over scalars (UTPS). This algebraic structure is of fundamental importance, e.g. for higher order algorithmic differentiation or Taylor series integrators for ODEs/DAEs. The algorithms are vectorized in the higher order coefficients.
\end{abstract}
\paragraph{Rationale}
A truncated univariate Taylor polynomial (UTP) $[x]_D := \sum_{d=0}^{D-1} x_d t^d,\; x \in \R$ is an element of the polynomial factor ring $R[t]/t^D$. The variable $t$ is an external parameter, i.e. the polynomial $[x]_D$ is never evaluated for a numerical $t$. The UTPs are of high importance, e.g. for use in algorithmic differentiation (AD), high order polynomial models and Taylor series integrators of ODEs/DAEs. In the following we focus on the motivation from an AD point of view.
In AD, truncated Taylor polynomials allow to compute higher order derivatives. As a simple example we differentiate the function $f: \R^N \rightarrow R, \; x \mapsto y = f(x)$ in the so-called \emph{forward mode of AD}:
\begin{eqnarray}
\left. \frac{\dd}{\dd t} f( x + V t) \right|_{t=0} &=& \frac{\partial f}{\partial x} V \;,
\end{eqnarray}
where $V \in R^{N \times P}$. If the gradient $\nabla f(x_0)$ is desired one can set $V$ to the identity matrix $\Id_N$ and one obtains 
\begin{eqnarray}
 \left. \frac{\dd}{\dd t} f( x + V t) \right|_{t=0} &=& \frac{\partial f}{\partial x} \Id_N = \nabla f(x)\;.
\end{eqnarray}
This generalizes to higher order derivatives by computing 
\begin{eqnarray}
\left. \frac{1}{D!}\frac{\dd^D}{\dd t^D} f(x + Vt) \right|_{t=0} &=& \nabla^D f(x) \{ V,\dots, V \} \;.
\end{eqnarray}
The off-diagonal elements of the derivative tensor $\nabla^D f(x)$ can be computed by a technique called \emph{exact interpolation} \cite{Griewank2008EDP}.

\paragraph{Data Structure and Algorithms}
The basic data structure is an array $[x]_{D+1}$ with coefficients
\begin{eqnarray*}
\;[x]_{D+1} &=& [x_0, x_1, \dots, x_D] \quad \quad \mbox{not vectorized} \\
\;[x]_{D+1; P} &=& [x_0, x_{11}, \dots, x_{1,D-1}, x_{21}, \dots, x_{P,D-1}] \quad \quad \mbox{vectorized} \;.
\end{eqnarray*}
I.e. the zero'th coefficient $x_0$ is the same for all $P$ directions.

To show how the algorithms have to work, we restrict to $P=1$ and look at the polynomial multiplication $z = \mul(x,y)$:
\begin{eqnarray}
[z]_{D+1} &\stackrel{D+1}{=}& [x]_{D+1} y_{D+1} \\
\sum_{d=0}^D z_d t^d &\stackrel{D+1}{=}& \left( \sum_{d=0}^D x_d t^d \right) \left( \sum_{c=0}^D y_c t^c \right)   \\
&\stackrel{D+1}{=}& \sum_{d=0}^D \sum_{k=0}^d x_k y_{d-k} t^d \\
&\stackrel{D+1}{=}& x_0 y_0 + \sum_{d=1}^D \left( \sum_{k=1}^{d-1} x_k y_{d-k} + x_0 y_d + x_d y_0 \right)  t^d \;,
\end{eqnarray}
We have used $\stackrel{D+1}{=}$ to express equality up to order $D$. In Table \ref{tab:taylor_arithmetic_binary} and \ref{tab:taylor_arithmetic_univariate} a selection of important functions is collected. Typically, all algorithms in the C-header file \texttt{math.h} are implemented allowing the user to perform Taylor arithmetic of any computer program.



\begin{table}[!h]
\centering
\begin{tabular}{| c | l | l | l |}
\hline
$z= \phi(x,y)$  & $d = 0,\dots,D$ & OPS & MOVES \\
\hline
$x + cy$ & $z_d = x_d + c y_d$ & $2D$ & $3D$ \\
$x \times y $ & $z_d = \sum_{k=0}^d x_k  y_{d-k}$ & $D^2$ & $3D$\\
$x / y $ & $z_d = \frac{1}{y_0} \left[ x_d - \sum_{k=0}^{d-1} z_k y_{d-k} \right]$ & $D^2$ & $3D$\\
\hline
\end{tabular}

\caption{\label{tab:taylor_arithmetic_binary}
binary functions
}
\end{table}
\begin{table}[!h]
\centering
\begin{tabular}{| l | l | l | l |}
\hline 
$y = \phi(x)$  & $d = 0,\dots,D$ & OPS & MOVES \\
\hline \hline
$\ln(x)$ & $ \tilde y_d = \frac{1}{x_0} \left[ \tilde x_d - \sum_{k=1}^{d-1} x_{d-k} \tilde y_k \right]$ & $ D^2$ & $2D$\\
\hline
$\exp(x) $ & $ \tilde y_d = \sum_{k=1}^d y_{d-k} \tilde x_k$  & $ D^2$ & $2D$\\
\hline
$\sqrt{x}$ & $ y_d = \frac{1}{2 y_0} \left[ x_d - \sum_{k=1}^{d-1} y_k y_{d-k} \right] $ & $\frac{1}{2} D^2$ & $3D$\\
\hline
$ x^r$ & $ \tilde y_d = \frac{1}{x_0} \left[ r \sum_{k=1}^d y_{d-k} \tilde x_k - \sum_{k=1}^{d-1} x_{d-k} \tilde y_k \right]$ & $2 D^2$ & $2D$\\
\hline
$\sin(v)$ & $ \tilde s_d = \sum_{j=1}^d \tilde v_j c_{d-j}$  & $2 D^2$ & $3D$\\
$\cos(v)$ & $ \tilde c_d = \sum_{j=1}^d - \tilde  v_j s_{d-j} $ & & \\ 
\hline
$\tan(v)$ & $\tilde  \phi_d = \sum_{j=1}^d w_{d-j} \tilde v_j $ & & \\ 
& $\tilde w_d = 2 \sum_{j=1}^d \phi_{d-j} \tilde \phi_j$ & & \\ 
\hline
$\arcsin(v)$ & $ \tilde \phi_d = w_0^{-1} \left( \tilde v_d - \sum_{j=1}^{d-1} w_{d-j} \tilde \phi_j \right)$& & \\ 
& $ \tilde w_d = - \sum_{j=1}^d v_{d-j} \tilde \phi_j $ & & \\ 
\hline
$\arctan(v)$ & $ \tilde \phi_d = w_0^{-1} \left( \tilde v_d - \sum_{j=1}^{d-1} w_{d-j} \tilde \phi_j \right)$& & \\ 
& $ \tilde w_d = 2 \sum_{j=1}^d v_{d-j} \tilde v_j $ & & \\ 
\hline
\end{tabular}
\caption{\label{tab:taylor_arithmetic_univariate}
We use $\tilde v_j := j v_j$. The results have been adapted from \cite{Griewank2008EDP,Neidinger2005DfC}.
}
\end{table}
 

% \tableofcontents

% \input{introduction}



\bibliographystyle{plain}
\bibliography{refs}

\end{document} 
 
